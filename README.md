# RSA 文字加解密系统

这是一个基于大整数运算安全可靠的RSA加解密系统，使用C++实现，支持密钥随机生成、保存、加载和汉字的加密解密。

## ? 主要特性

### ?? 随机生成密钥对
- 每次根据安全等级随机生成不同的RSA密钥对（而非固定素数）
- 密钥可持久化保存到文件
- 自动检测并加载已有密钥
- 支持多种安全级别选择

### ? 安全的加解密
- 标准RSA算法实现
- 支持任意长度文本
- 支持中英文混合文本
- 完整的错误处理

### ? 友好的交互界面
- 菜单式操作界面
- 中文提示信息
- 操作结果清晰显示
- 输入验证和错误提示

## ?? 项目结构

```
RSA/
├── BigInt.h          # 大整数运算库
├── RSA.h             # RSA核心算法
├── PrimeGenerator.h  # 素数生成工具
├── KeyManager.h      # 密钥文件管理
├── main.cpp          # 主程序
├── README.md         # 说明文档
├── public_key.txt    # 公钥文件（运行后生成）
└── private_key.txt   # 私钥文件（运行后生成）
```

## ?? 使用指南

### 首次使用

1. **运行程序**
   ```
   RSA.exe
   ```

2. **生成密钥对**
   - 选择安全级别（推荐级别1或以上）
   - 系统自动生成并保存密钥对
   - 密钥保存在 `public_key.txt` 和 `private_key.txt`

3. **开始使用**
   - 选择"加密文本"输入要加密的内容
   - 复制密文发送给接收方
   - 使用"解密文本"还原密文

### 主菜单选项

```
==============================
    RSA 文字加解密系统
==============================
1. 生成新的RSA密钥对
2. 加密文本
3. 解密文本
4. 查看密钥信息
5. 重新加载密钥
0. 退出程序
==============================
```

### 安全级别说明

| 级别 | 素数范围 | 模数 n 大小 | 适用场景 |
|-----|---------|--------|---------|
| 0 | [50, 100] | ≈ 10,000 | 学习演示 |
| 1 | [900, 1100] | ≈ 1,000,000 | 一般文本 |
| 2 | [9000, 11000] | ≈ 100,000,000 | 重要文本 |
| 3 | [90000, 110000] | ≈ 10,000,000,000 | 敏感信息 |
| 4 | [900000, 1100000] | ≈ 1,000,000,000,000 | 机密信息 |

**注意**：每次生成密钥时，系统会在指定范围内随机选择两个不同的素数，确保每次生成的密钥对都是唯一的。

**推荐**：日常使用选择级别1或2，重要信息选择级别3或4

## ?? 使用示例

### 示例1：加密消息

```
请选择操作: 2

=== 加密文本 ===
请输入要加密的文本：
Hello, RSA加密系统！

正在加密...

? 加密成功！

原始文本：Hello, RSA加密系统！

密文（请妥善保管）：
72 101 108 108 111 44 32 82 83 65 ...
```

### 示例2：解密消息

```
请选择操作: 3

=== 解密文本 ===
请输入要解密的密文：
72 101 108 108 111 44 32 82 83 65 ...

正在解密...

? 解密成功！

解密后的文本：Hello, RSA加密系统！
```

## ?? 安全说明

### ? 安全实践

1. **保护私钥**
   - `private_key.txt` 必须妥善保管
   - 不要分享或传输私钥文件
   - 可以公开分享 `public_key.txt`

2. **密钥更新**
   - 定期生成新密钥对
   - 旧密钥加密的消息需要保留旧密钥才能解密

3. **备份策略**
   - 备份密钥文件到安全位置
   - 记录使用了哪个密钥加密哪些信息

### ?? 使用限制

1. **文本长度**
   - 单次加密支持任意长度文本
   - 每个字符独立加密

2. **性能考虑**
   - 大量文本加密较慢
   - 建议单次不超过10KB文本

3. **字符支持**
   - 支持ASCII和UTF-8编码
   - 支持中英文、数字、符号

## ?? 技术细节

### RSA算法原理

1. **密钥生成**
   ```
   选择两个大素数 p 和 q
   计算 n = p × q
   计算 φ(n) = (p-1) × (q-1)
   选择 e，满足 gcd(e, φ(n)) = 1
   计算 d = e^(-1) mod φ(n)
   公钥：(e, n)
   私钥：(d, n)
   ```

2. **加密过程**
   ```
   将字符转换为数字 m
   计算密文 c = m^e mod n
   ```

3. **解密过程**
   ```
   计算明文 m = c^d mod n
   将数字转换回字符
   ```

### 核心类说明

**BigInt** - 大整数运算
- 支持加减乘除取模
- 模幂运算优化
- GCD和模逆计算

**RSA** - 加密核心
- 密钥生成和管理
- 加密解密实现
- 密钥文件I/O

**KeyManager** - 密钥管理
- 密钥保存/加载
- 文件格式处理
- 密钥验证

**PrimeGenerator** - 素数工具
- 预定义安全素数对
- 米勒-拉宾素性测试
- 随机素数生成

## ?? 编译和运行

### Visual Studio
```
直接打开解决方案文件编译运行
或按 F5 启动调试
```

### 命令行编译
```bash
cl /EHsc /std:c++14 main.cpp
```

### 运行
```bash
RSA.exe
```

## ?? 注意事项

1. **首次运行**会提示生成密钥对
2. **密钥文件**生成后会保存在程序目录
3. **加密的密文**是数字序列，用空格分隔
4. **私钥丢失**无法恢复已加密的数据
5. **跨平台**使用需确保密钥文件编码一致

## ?? 功能扩展建议

- [ ] 支持文件加密
- [ ] 添加数字签名功能
- [ ] 实现OAEP填充
- [ ] GUI图形界面
- [ ] 网络传输支持
- [ ] 密钥导入导出功能

## ?? 许可证

本项目仅供学习和研究使用。

## ?? 贡献

欢迎提出问题和改进建议！
